<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="RGCCA is a general statistical framework for multiblock data analysis.
The rgcca() function implements this framework and is the main entry point
of the package."><title>Regularized Generalized Canonical Correlation Analysis (RGCCA) — rgcca • RGCCA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regularized Generalized Canonical Correlation Analysis (RGCCA) — rgcca"><meta property="og:description" content="RGCCA is a general statistical framework for multiblock data analysis.
The rgcca() function implements this framework and is the main entry point
of the package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RGCCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/RGCCA.pdf">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rgcca-factory/RGCCA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Regularized Generalized Canonical Correlation Analysis (RGCCA)</h1>
      <small class="dont-index">Source: <a href="https://github.com/rgcca-factory/RGCCA/blob/HEAD/R/rgcca.R" class="external-link"><code>R/rgcca.R</code></a></small>
      <div class="d-none name"><code>rgcca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>RGCCA is a general statistical framework for multiblock data analysis.
The rgcca() function implements this framework and is the main entry point
of the package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rgcca</span><span class="op">(</span></span>
<span>  <span class="va">blocks</span>,</span>
<span>  connection <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scheme <span class="op">=</span> <span class="st">"factorial"</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"svd"</span>,</span>
<span>  bias <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale_block <span class="op">=</span> <span class="st">"inertia"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"rgcca"</span>,</span>
<span>  sparsity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  superblock <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  NA_method <span class="op">=</span> <span class="st">"na.ignore"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_iter_max <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  comp_orth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  A <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  C <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>blocks</dt>
<dd><p>A list that contains the \(J\) blocks of variables
\(\mathbf{X_1}, \mathbf{X_2}, ..., \mathbf{X_J}\).
Block \(\mathbf{X}_j\) is a matrix of dimension
\(n \times p_j\) where \(n\) is the number of
observations and \(p_j\) the number of variables. The blocks argument can
be also a fitted cval, rgcca or permutation object.</p></dd>


<dt>connection</dt>
<dd><p>A (\(J \times J\)) symmetric matrix describing
the network of connections between blocks (default value: 1-diag(J)).</p></dd>


<dt>tau</dt>
<dd><p>Either a numerical value, a numeric vector of size
\(J\), or a
numeric matrix of dimension
\(\mathrm{max}(\textrm{ncomp}) \times J\)
containing the values of the regularization parameters
(default: tau = 1, for each
block and each dimension), or a string equal to "optimal".
The regularization parameters varies from 0 (maximizing the correlation) to
1 (maximizing the covariance).</p>
<p>If tau is a numerical
value, tau is identical across all constraints applied to all
block weight vectors.</p>
<p>If tau is a vector, tau[j] is used for the constraints applied to
all the block weight vectors associated to block \(\mathbf X_j\).</p>
<p>If tau is a matrix, tau[k, j] is associated with the constraints
applied to the kth block weight vector corresponding to block
\(\mathbf X_j\).</p>
<p>If tau = "optimal" the regularization
parameters are estimated for each block and each dimension using the Schafer
and Strimmer (2005) analytical formula. The tau parameters can also be
estimated using
<a href="rgcca_permutation.html">rgcca_permutation</a> or <a href="rgcca_cv.html">rgcca_cv</a>.</p></dd>


<dt>ncomp</dt>
<dd><p>A numerical value or a vector of length \(J\) indicating
the number of components per block. If a single value is provided,
the same number of components is extracted for every block.</p></dd>


<dt>scheme</dt>
<dd><p>A string or a function specifying the scheme function applied
to
covariance maximization among "horst" (the identity function), "factorial"
 (the square function - default value), "centroid" (the absolute value
 function). The scheme function can be any continuously differentiable convex
 function and it is possible to design explicitly the scheme function
 (e.g. function(x) x^4) as argument of the function.  See (Tenenhaus et al,
 2017) for details.</p></dd>


<dt>scale</dt>
<dd><p>A logical value indicating if variables are standardized.</p></dd>


<dt>init</dt>
<dd><p>A string giving the type of initialization to use in
the RGCCA algorithm. It could be either by
Singular Value Decompostion ("svd")
or by random initialization ("random") (default: "svd").</p></dd>


<dt>bias</dt>
<dd><p>A logical value for biased (\(1/n\)) or unbiased
(\(1/(n-1)\)) estimator of the variance/covariance
(default: bias = TRUE).</p></dd>


<dt>tol</dt>
<dd><p>The stopping value for the convergence of the algorithm
(default: tol = 1e-08).</p></dd>


<dt>verbose</dt>
<dd><p>A logical value indicating if the progress of the
algorithm is reported while computing.</p></dd>


<dt>scale_block</dt>
<dd><p>A logical value or a string indicating if each block is
scaled.</p>
<p>If TRUE or "inertia", each block is divided by the sum of eigenvalues
of its empirical covariance matrix.</p>
<p>If "lambda1", each block is divided by
the square root of the highest eigenvalue of its empirical covariance matrix.</p>
<p>If standardization is applied (scale = TRUE), the block scaling applies on
the standardized blocks.</p></dd>


<dt>method</dt>
<dd><p>A string specifying which multiblock component
method to consider. Possible values are found using
<a href="available_methods.html">available_methods</a>.</p></dd>


<dt>sparsity</dt>
<dd><p>Either a numerical value, a numeric vector of
size \(J\) or a numeric matrix
of dimension \(\textrm{max}(\textrm{ncomp}) \times J\) encoding the L1
constraints applied to the
block weight vectors. For block \(j\), the amount of
sparsity varies between
\(1/\textrm{sqrt}(p_j)\) and 1 (larger values of sparsity
correspond to less penalization).</p>
<p>If sparsity is a numerical value, then sparsity is identical across
all constraints applied to all block weight vectors.</p>
<p>If sparsity is a vector, sparsity[j] is identical across the constraints
applied to the block weight vectors associated to block
\(\mathbf X_j\):
$$
   \forall k, \Vert a_{j,k} \Vert_{1} \le \textrm{sparsity}[j] \sqrt{p_j}.
$$</p>
<p>If sparsity is a matrix, sparsity[k, j] is associated with the constraints
applied to the kth block weight vector corresponding to block
\(\mathbf X_j\):
$$
   \Vert a_{j,k}\Vert_{1} \le \textrm{sparsity}[k,j] \sqrt{p_j}.
$$</p>
<p>The sparsity parameter can be estimated by using <a href="rgcca_permutation.html">rgcca_permutation</a> or
<a href="rgcca_cv.html">rgcca_cv</a>.</p></dd>


<dt>response</dt>
<dd><p>A numerical value giving the position of the response block.
When the response argument is filled, the supervised mode is automatically
activated.</p></dd>


<dt>superblock</dt>
<dd><p>A logical value indicating if the
superblock option is used.</p></dd>


<dt>NA_method</dt>
<dd><p>A string indicating the method used for
handling missing values ("na.ignore", "na.omit"). (default: "na.ignore").</p><ul><li><p>"na.omit" corresponds to perform RGCCA on the fully observed
observations (observations from which missing values have been removed).</p></li>
<li><p>"na.ignore" corresponds to perform RGCCA algorithm on available
data (See Tenenhaus et al, 2005).</p></li>
</ul></dd>


<dt>quiet</dt>
<dd><p>A logical value indicating if some diagnostic messages
are reported.</p></dd>


<dt>n_iter_max</dt>
<dd><p>Integer giving the algorithm's maximum number of
iterations.</p></dd>


<dt>comp_orth</dt>
<dd><p>A logical value indicating if the deflation should lead to
orthogonal block components or orthogonal block weight vectors.</p></dd>


<dt>A</dt>
<dd><p>Deprecated argument, please use blocks instead.</p></dd>


<dt>C</dt>
<dd><p>Deprecated argument, please use connection instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A fitted rgcca object.</p>
<dl><dt>Y</dt>
<dd><p>A list of \(J\) elements. The jth element
of the list \(Y\)
is a matrix that contains the block components for block j.</p></dd>


<dt>a</dt>
<dd><p>A list of \(J\) elements. The jth element
of the list \(a\)
is a matrix that contains the block weight vectors for block j.</p></dd>


<dt>astar</dt>
<dd><p>A list of \(J\) elements. Each column of astar[[j]] is
a vector such that Y[[j]] = blocks[[j]] %*% astar[[j]].</p></dd>


<dt>crit</dt>
<dd><p>A list of vector of length max(ncomp). Each vector of
the list is related to one specific deflation stage and reports the values
of the criterion for this stage across iterations.</p></dd>


<dt>primal_dual</dt>
<dd><p>A vector of length J. Element \(j\)
is either "primal" or "dual", depending on whether the primal or dual
RGCCA algorithm was used for block \(j\).</p></dd>


<dt>AVE</dt>
<dd><p>A list of numerical values giving the indicators of model
quality based on the Average Variance Explained (AVE): AVE(for each block),
AVE(outer model), AVE(inner model).</p></dd>


<dt>optimal</dt>
<dd><p>A logical value indicating if the Schaffer and
Strimmer formula was applied for estimating the optimal tau parameters.</p></dd>


<dt>opt</dt>
<dd><p>A list containing some options of
the fitted RGCCA object.</p></dd>


<dt>call</dt>
<dd><p>Call of the function.</p></dd>


<dt>blocks</dt>
<dd><p>A list that contains the \(J\)
blocks of variables
\(\mathbf X_1, \mathbf X_2, \dots, \mathbf X_J\).
Block \(\mathbf X_j\) is a matrix of dimension
\(n \times p_j\) where \(p_j\) is the number of
variables in \(\mathbf X_j\). These blocks are preprocessed
according to the values of
scale/scale_block/NA_method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given \(J\) data matrices
\(\mathbf X_1, \mathbf X_2, \dots, \mathbf X_J\)
that represent \(J\) sets of variables
observed on the same set of \(n\) individuals. These matrices
\(\mathbf X_1, \mathbf X_2, \dots, \mathbf X_J\),
called blocks must have the same number of rows, but may (and usually will)
have different numbers of columns.</p>
<p>RGCCA aims to study the relationships between these \(J\) blocks.
It constitutes a general framework for many multi-block component methods
(see Tenenhaus and Tenenhaus, 2011 ; Tenenhaus et al. 2017). It combines the
power of multi-block data analysis  methods (maximization of well identified
criteria) and the flexibility of PLS path modeling (the researcher decides
which blocks are connected and which are not). Hence, the use of RGCCA
requires the construction (user specified) of a design matrix
\(\mathbf C\) that
characterizes the connections between blocks. Elements of the (symmetric)
design matrix \(\mathbf C = (c_{jk})\)
are positive (and usually equal to 1 if blocks \(j\)
and \(k\) are connected, and 0 otherwise).
The rgcca() function implements
a monotone global convergent algorithm: the bounded criteria to be
maximized increases at each step of the iterative procedure and hits, at
convergence, a stationary point of the RGCCA optimization problem.</p>
<p>Moreover,
when the tau argument is used, depending on the dimensionality of each block
\(\mathbf X_j, j = 1, \ldots, J\),
the primal algorithm (when \(n \geq p_j\)) or the dual algorithm
(when \(n &lt; p_j\)) is used (see Tenenhaus et al. 2015).</p>
<p>When sparsity is
specified SGCCA, extends RGCCA to address the issue of variable selection
(Tenenhaus et al, 2014). Specifically, RGCCA is combined with an L1-penalty
that gives rise to Sparse GCCA (SGCCA). The SGCCA algorithm is very similar
to the RGCCA algorithm and keeps the same convergence properties (i.e. the
bounded criteria to be maximized increases at each step of the iterative
procedure and hits at convergence a stationary point).</p>
<p>At last, a deflation strategy can be used to compute several block
components
(specified by ncomp) per block. Within each block, components or weight
vectors are guaranteed to be orthogonal. It should be noted that the numbers
of components per block can differ from one block to another.</p>
<p>The rgcca() function handle missing values (punctual or blockwise missing
structure) using the algorithm described in (Tenenhaus et al, 2005).</p>
<p>Guidelines describing how to use RGCCA in practice are provided in
(Garali et al., 2018).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Garali I, Adanyeguh IM, Ichou F, Perlbarg V, Seyer A, Colsch B,
Moszer I, Guillemot V, Durr A, Mochel F, Tenenhaus A. (2018) A strategy for
multimodal data integration: application to biomarkers identification
in spinocerebellar ataxia. Briefings in Bioinformatics. 19(6):1356-1369.</p>
<p>Tenenhaus M., Tenenhaus A. and Groenen P. J. (2017). Regularized
generalized canonical correlation analysis: a framework for sequential
multiblock component methods. Psychometrika, 82(3), 737-777.</p>
<p>Tenenhaus A., Philippe C. and Frouin, V. (2015). Kernel
generalized canonical correlation analysis. Computational Statistics and
Data Analysis, 90, 114-131.</p>
<p>Tenenhaus A., Philippe C., Guillemot V., Le Cao K. A., Grill J.
and Frouin, V. (2014), Variable selection for generalized canonical
correlation analysis, Biostatistics, 15(3), pp. 569-583.</p>
<p>Tenenhaus A. and Tenenhaus M., (2011). Regularized Generalized
Canonical Correlation Analysis, Psychometrika, 76(2), pp 257-284.</p>
<p>Tenenhaus, M., Vinzi, V. E., Chatelin, Y. M., &amp; Lauro, C. (2005).
PLS path modeling. Computational statistics &amp; data analysis, 48(1), 159-205.</p>
<p>Schafer J. and Strimmer K. (2005). A shrinkage approach to
large-scale covariance matrix estimation and implications for functional
genomics. Statistical Applications in Genetics and Molecular Biology 4:32.</p>
<p>Arnaud Gloaguen, Vincent Guillemot, Arthur Tenenhaus.
An efficient algorithm to satisfy l1 and l2 constraints.
49emes Journees de Statistique, May 2017, Avignon, France. (hal-01630744)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.html">plot.rgcca</a></code>, <code><a href="print.html">print.rgcca</a></code>,
<code><a href="rgcca_cv.html">rgcca_cv</a></code>,
<code><a href="rgcca_permutation.html">rgcca_permutation</a></code>
<code><a href="rgcca_predict.html">rgcca_predict</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">####################</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: RGCCA #</span></span></span>
<span class="r-in"><span><span class="co">####################</span></span></span>
<span class="r-in"><span><span class="co"># Create the dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  agriculture <span class="op">=</span> <span class="va">Russett</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  industry <span class="op">=</span> <span class="va">Russett</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  politic <span class="op">=</span> <span class="va">Russett</span><span class="op">[</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">politic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Russett</span><span class="op">[</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># RGCCA with default values : Blocks are fully connected, factorial scheme</span></span></span>
<span class="r-in"><span><span class="co"># tau = 1 for all blocks, one component per block.</span></span></span>
<span class="r-in"><span><span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span>blocks <span class="op">=</span> <span class="va">blocks</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: method='rgcca', superblock=FALSE, scale=TRUE, scale_block='inertia',</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> init='svd', bias=TRUE, tol=1e-08, NA_method='na.ignore', ncomp=c(1,1,1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> response=NULL, comp_orth=TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are J = 3 blocks.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The design matrix is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             agriculture industry politic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agriculture           0        1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> industry              1        0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> politic               1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The factorial scheme is used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum_{j,k} c_jk g(cov(X_j a_j, X_k a_k) = 0.7172 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for agriculture is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for industry is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for politic is: 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rgcca</span>, type <span class="op">=</span> <span class="st">"weight"</span>, block <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rgcca-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rgcca</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"sample"</span>, block <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>  comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, resp <span class="op">=</span> <span class="va">politic</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rgcca-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: RGCCA and multiple components #</span></span></span>
<span class="r-in"><span><span class="co">############################################</span></span></span>
<span class="r-in"><span><span class="co">#  By default rgcca() returns orthogonal block components.</span></span></span>
<span class="r-in"><span><span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span><span class="va">blocks</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"rgcca"</span>,</span></span>
<span class="r-in"><span>  connection <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  superblock <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  scheme <span class="op">=</span> <span class="st">"factorial"</span>,</span></span>
<span class="r-in"><span>  comp_orth <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computation of the RGCCA block components based on the factorial scheme </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shrinkage intensity parameters are chosen manually </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computation of the RGCCA block components #1 is under progress...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    1  Fit:  0.71713961  Dif:  0.06767066 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    2  Fit:  0.71721572  Dif:  0.00007611 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    3  Fit:  0.71721585  Dif:  0.00000013 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    4  Fit:  0.71721585  Dif:  0.00000000 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The RGCCA algorithm converged to a stationary point after 3 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computation of the RGCCA block components #2 is under progress...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    1  Fit:  0.02960087  Dif:  0.01358225 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    2  Fit:  0.02985623  Dif:  0.00025536 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    3  Fit:  0.02985666  Dif:  0.00000043 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iter:    4  Fit:  0.02985666  Dif:  0.00000000 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The RGCCA algorithm converged to a stationary point after 3 iterations </span>
<span class="r-plt img"><img src="rgcca-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="rgcca-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: method='rgcca', superblock=FALSE, scale=TRUE, scale_block='inertia',</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> init='svd', bias=TRUE, tol=1e-08, NA_method='na.ignore', ncomp=c(2,2,2),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> response=NULL, comp_orth=TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are J = 3 blocks.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The design matrix is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             agriculture industry politic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agriculture           0        1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> industry              1        0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> politic               1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The factorial scheme is used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum_{j,k} c_jk g(cov(X_j a_j, X_k a_k) = 0.7471 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for agriculture is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for industry is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for politic is: 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rgcca</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"sample"</span>, block <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  comp <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, resp <span class="op">=</span> <span class="va">politic</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rgcca-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rgcca</span>, type <span class="op">=</span> <span class="st">"weight"</span>,</span></span>
<span class="r-in"><span>     block <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, display_order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rgcca-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##############################</span></span></span>
<span class="r-in"><span><span class="co"># Example 3: MCOA with RGCCA #</span></span></span>
<span class="r-in"><span><span class="co">##############################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span><span class="va">blocks</span>, method <span class="op">=</span> <span class="st">"mcoa"</span>, ncomp <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: method='mcoa', superblock=TRUE, scale=TRUE, scale_block='inertia', init='svd',</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bias=TRUE, tol=1e-08, NA_method='na.ignore', ncomp=c(2,2,2,2), response=NULL,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp_orth=FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are J = 4 blocks.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The design matrix is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             agriculture industry politic superblock</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agriculture           0        0       0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> industry              0        0       0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> politic               0        0       0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> superblock            1        1       1          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The factorial scheme is used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum_{j,k} c_jk g(cov(X_j a_j, X_k a_k) = 3.4826 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for agriculture is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for industry is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for politic is: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The regularization parameter used for superblock is: 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># biplot representation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rgcca</span>, type <span class="op">=</span> <span class="st">"biplot"</span>, block <span class="op">=</span> <span class="fl">4</span>, resp <span class="op">=</span> <span class="va">politic</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rgcca-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">####################################</span></span></span>
<span class="r-in"><span>  <span class="co"># Example 4: RGCCA and permutation #</span></span></span>
<span class="r-in"><span>  <span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Tune the model to find the best set of tau parameters.</span></span></span>
<span class="r-in"><span>  <span class="co"># By default, blocks are fully connected.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27</span><span class="op">)</span> <span class="co">#favorite number</span></span></span>
<span class="r-in"><span>  <span class="va">perm_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgcca_permutation.html">rgcca_permutation</a></span><span class="op">(</span><span class="va">blocks</span>,</span></span>
<span class="r-in"><span>    n_cores <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    par_type <span class="op">=</span> <span class="st">"tau"</span>,</span></span>
<span class="r-in"><span>    n_perms <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">perm_out</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">perm_out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># all the parameters were imported from a fitted permutation object</span></span></span>
<span class="r-in"><span>  <span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span><span class="va">perm_out</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#######################################</span></span></span>
<span class="r-in"><span>  <span class="co"># Example 5: RGCCA and dual algorithm #</span></span></span>
<span class="r-in"><span>  <span class="co">#######################################</span></span></span>
<span class="r-in"><span>  <span class="co"># Download the dataset's package at http://biodev.cea.fr/sgcca/ and install</span></span></span>
<span class="r-in"><span>  <span class="co"># it from the package archive file.</span></span></span>
<span class="r-in"><span>  <span class="co"># You can do it with the following R commands:</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"gliomaData"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">destfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"http://biodev.cea.fr/sgcca/gliomaData_0.4.tar.gz"</span>, <span class="va">destfile</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">destfile</span>, repos <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ge_cgh_locIGR"</span>, package <span class="op">=</span> <span class="st">"gliomaData"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">multiblocks</span></span></span>
<span class="r-in"><span>  <span class="va">Loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Loc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ge_cgh_locIGR</span><span class="op">$</span><span class="va">multiblocks</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">blocks</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Loc</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">blocks</span>, <span class="va">NCOL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># rgcca algorithm using the dual formulation for X1 and X2</span></span></span>
<span class="r-in"><span>  <span class="co"># and the dual formulation for X3. X3 is the group coding matrix associated</span></span></span>
<span class="r-in"><span>  <span class="co"># with the qualitative variable Loc. This block is considered</span></span></span>
<span class="r-in"><span>  <span class="co"># as response block and specified using the argument response.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span></span></span>
<span class="r-in"><span>    blocks <span class="op">=</span> <span class="va">blocks</span>,</span></span>
<span class="r-in"><span>    response <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"rgcca"</span>,</span></span>
<span class="r-in"><span>    tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncomp <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    scheme <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span>, <span class="co">#factorial scheme,</span></span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit_rgcca</span><span class="op">$</span><span class="va">primal_dual</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">###########################################</span></span></span>
<span class="r-in"><span>  <span class="co"># Example 6: RGCCA and variable selection #</span></span></span>
<span class="r-in"><span>  <span class="co">###########################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Variable selection and RGCCA : the sgcca algorithm</span></span></span>
<span class="r-in"><span>  <span class="va">fit_sgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span></span></span>
<span class="r-in"><span>    blocks <span class="op">=</span> <span class="va">blocks</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"sgcca"</span>,</span></span>
<span class="r-in"><span>    response <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    sparsity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.071</span>, <span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span>, ncomp <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    scheme <span class="op">=</span> <span class="st">"factorial"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_sgcca</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">############################################</span></span></span>
<span class="r-in"><span>  <span class="co">#  Example 7: RGCCA, multiple components   #</span></span></span>
<span class="r-in"><span>  <span class="co">#  and different penalties per component   #</span></span></span>
<span class="r-in"><span>  <span class="co">############################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># S/RGCCA algorithm with multiple components and different</span></span></span>
<span class="r-in"><span>  <span class="co"># penalties for each components (-&gt; sparsity is a matrix)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span><span class="va">blocks</span>, response <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, scheme <span class="op">=</span> <span class="st">"factorial"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># the same applies for SGCCA</span></span></span>
<span class="r-in"><span>  <span class="va">fit_sgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span><span class="va">blocks</span>, response <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    sparsity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.071</span>, <span class="fl">0.2</span>,  <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">0.06</span>, <span class="fl">0.15</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, scheme <span class="op">=</span> <span class="st">"factorial"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_sgcca</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">##################################################</span></span></span>
<span class="r-in"><span>  <span class="co"># Example 8: Supervised mode en cross validation #</span></span></span>
<span class="r-in"><span>  <span class="co">##################################################</span></span></span>
<span class="r-in"><span>  <span class="co"># Prediction of the location from GE and CGH</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Tune sparsity values based on the cross-validated accuracy.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27</span><span class="op">)</span> <span class="co">#favorite number</span></span></span>
<span class="r-in"><span>  <span class="va">cv_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgcca_cv.html">rgcca_cv</a></span><span class="op">(</span><span class="va">blocks</span>, response <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                     par_type <span class="op">=</span> <span class="st">"sparsity"</span>,</span></span>
<span class="r-in"><span>                     par_length <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                     ncomp <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     prediction_model <span class="op">=</span> <span class="st">"lda"</span>,</span></span>
<span class="r-in"><span>                     metric <span class="op">=</span> <span class="st">"Accuracy"</span>,</span></span>
<span class="r-in"><span>                     k <span class="op">=</span> <span class="fl">3</span>, n_run <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                     n_cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cv_out</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_out</span>, display_order <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># all the parameters were imported from the fitted cval object.</span></span></span>
<span class="r-in"><span>  <span class="va">fit_rgcca</span> <span class="op">&lt;-</span> <span class="fu">rgcca</span><span class="op">(</span><span class="va">cv_out</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_rgcca</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Fabien Girka, Etienne Camenen, Caroline Peltier, Arnaud Gloaguen, Vincent Guillemot, Arthur Tenenhaus.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

